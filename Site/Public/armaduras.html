<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ironheart | Armaduras</title>
    <link rel="stylesheet" href="armaduras.css">
    <link rel="icon" href="logo/Ironheart (logo).png" </head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<body onload="obterDadosGrafico">

    <header>

        <nav class="nav-container" id="nav">

            <img class="logo" src="logo/Ironheart (white logo without ribbon at the side of the shield).png">
            <ul class="nav-list">

                <li>
                    <a href="index.html">Home
                        <div class="barra"></div>
                    </a>
                </li>

                <li>
                    <a href="curiosidades.html">Curiosidades
                        <div class="barra"></div>
                    </a>
                </li>

                <li>
                    <a href="cavaleirosrenomados.html">Cavaleiros Renomados
                        <div class="barra"></div>
                    </a>
                </li>

                <li>
                    <a href="armaduras.html">Armaduras
                        <div class="barra"></div>
                    </a>
                </li>

                <li>
                    <a href="armamentos.html">Armamentos
                        <div class="barra"></div>
                    </a>
                </li>

                <li>
                    <span style="color: white;">|</span>
                </li>

                <li>
                    <a href="login.html">Login
                        <div class="barra"></div>
                    </a>
                </li>


                <li>
                    <a href="cadastro.html">Cadastro
                        <div class="barra"></div>
                    </a>
                </li>
            </ul>

        </nav>

    </header>

    <main id="armaduras">

        <div class="container">

            <div class="content">

                <p id="paragraphTitle">ARMADURAS</p>

                <p id="paragraph">
                    As armaduras de placa medievais foram utilizadas por cavaleiros e soldados durante a idade média,
                    abrangendo
                    um período aproximado do século XIV ao século XVI. Essas armaduras eram projetadas para proteger o
                    usuário contra ataques de armas como espadas, lanças, flechas e machados, oferecendo uma combinação
                    de proteção e mobilidade e também estilo.

                    Existem vários estilos de armaduras, cada um com suas próprias características distintas. Embora nem
                    todos os trajes de armadura seguissem um padrão específico, abaixo serão mostrados os
                    4 estilos mais comuns da época:
                </p>

                <div id="estiloMilanes">

                    <p id="paragraph">
                        <span id="destaque">Estilo Milanês:</span> <br> <br>
                        A armadura Milanesa, é um tipo de armadura medieval que
                        se desenvolveu na cidade de Milão, na Itália, durante os séculos XIV e XV. Ela era amplamente
                        utilizada por cavaleiros e soldados na Europa Ocidental. <br>

                        A característica distintiva da armadura Milanesa é o seu estilo elegante e articulado, que
                        oferecia ao usuário um alto nível de proteção sem sacrificar a mobilidade. A armadura consistia
                        em várias placas de aço interligadas, que eram ajustadas ao corpo do usuário e permitiam um
                        movimento relativamente livre. <br>

                        A armadura Milanesa cobria todas as partes vitais do corpo, incluindo a cabeça, pescoço, ombros,
                        braços, mãos, tórax, costas, pernas e pés. Cada peça da armadura era feita sob medida para se
                        encaixar no corpo do usuário e proporcionar proteção eficaz contra ataques de armas de corte,
                        perfuração e esmagamento. <br>

                        Uma característica notável da armadura Milanesa é o capacete, conhecido como "elmo Milanês".
                        Este elmo
                        apresentava uma viseira articulada que podia ser levantada para melhorar a visão e a audição do
                        usuário quando não estava no meio de uma batalha. <br>

                        No geral, a armadura Milanesa foi uma inovação significativa no campo das armaduras medievais,
                        combinando proteção eficaz com uma excelente mobilidade. Ela foi amplamente usada por cavaleiros
                        e soldados em toda a Europa e deixou um legado duradouro na história da armadura medieval. <br>
                    </p>

                    <div class="imgArmadura">
                        <img class="armadura1" src="img-armour/milanesearmor1.jpg">
                        <img class="armadura1" src="img-armour/milanesearmor2.jpg">
                        <img class="armadura1" src="img-armour/milanesearmor3.jpg">
                    </div>

                </div>

                <div id="estiloGotico">

                    <p id="paragraph">
                        <span id="destaque">Estilo Gótico:</span> <br> <br>
                        A armadura Gótica, é um estilo de armadura
                        medieval que se desenvolveu durante o início do século XV na Europa
                        Ocidental, principalmente na região conhecida como Sacro Império Romano. Esse estilo
                        foi influenciado pela arquitetura Gótica da época, caracterizada por suas linhas altas e
                        esguias. <br>

                        A armadura Gótica consistia em placas de aço que eram articuladas e conectadas entre si por meio
                        de rebites ou correias de couro. Ela cobria todas as partes vitais do corpo, incluindo cabeça,
                        pescoço, ombros, braços, mãos, tórax, costas, pernas e pés. A armadura era projetada de forma a
                        proporcionar uma excelente proteção contra uma variedade de ataques de armas, ao mesmo tempo em
                        que permitia mobilidade e flexibilidade ao usuário. <br>

                        Uma das características distintivas da armadura Gótica é a forma afunilada das peças. Elas são
                        projetadas para se ajustarem ao contorno do corpo e seguir as linhas naturais do usuário,
                        proporcionando um encaixe confortável e um perfil elegante. Além disso, as placas costumavam ter
                        bordas escalonadas, conhecidas como "bordas em lâmina de serra", que ajudavam a aumentar a
                        resistência estrutural da armadura. <br>

                        O elmo gótico era uma parte fundamental da armadura. Ele apresentava uma viseira articulada que
                        podia ser levantada para permitir melhor visibilidade e respiração quando não havia combate
                        iminente. O elmo também tinha uma parte traseira alongada chamada de "grande bacinete", que
                        protegia a nuca e parte do pescoço. <br>

                        A armadura Gótica foi amplamente usada por cavaleiros e soldados durante o final da Idade Média.
                        Ela refletia os avanços técnicos na fabricação de armaduras e se tornou um símbolo de prestígio
                        e poder militar. Ainda hoje, a armadura Gótica é considerada um exemplo clássico do design e da
                        engenharia das armaduras medievais. <br>
                    </p>

                    <div class="imgArmadura">
                        <img class="armadura2" src="img-armour/gothicarmor1.jpg">
                        <img class="armadura2" src="img-armour/gothicarmor2.jpg">
                        <img class="armadura2" src="img-armour/gothicarmor3.jpg">
                    </div>

                </div>

                <div id="estiloMaximiliano">

                    <p id="paragraph">
                        <span id="destaque">Estilo Maximiliano:</span> <br> <br>
                        A armadura Maximiliana, é um tipo de
                        armadura medieval que se desenvolveu durante o reinado do Sacro Imperador Romano <span
                            id="destaque2">Maximiliano I</span> no final do
                        século XV e início do século XVI. Essa armadura recebeu influências da Renascença e é conhecida
                        por sua estética elaborada e ornamental. <br>

                        A armadura Maximiliana era feita de placas de aço que eram meticulosamente trabalhadas e
                        decoradas. Ela cobria todo o corpo, incluindo a cabeça, pescoço, ombros, braços, mãos, tórax,
                        costas, pernas e pés. A armadura era projetada para fornecer uma excelente proteção, ao mesmo
                        tempo em que oferecia um visual impressionante e elegante. <br>

                        Uma das características distintivas da armadura Maximiliana é a presença de linhas arrojadas e
                        curvas fluidas. Ela tinha peitorais ampliados, ombreiras esculpidas e cotas de malha adornadas,
                        que adicionavam volume e uma sensação de grandeza ao conjunto. Além disso, as placas eram
                        frequentemente decoradas com relevos, gravuras e incrustações de metais preciosos, como ouro e
                        prata. <br>

                        O elmo era uma parte proeminente dessa
                        armadura. Ele apresentava uma viseira grande e pronunciada, muitas vezes decorada com desenhos
                        intricados, e uma crista decorativa no topo. O elmo podia ser removido, permitindo ao usuário
                        uma melhor visão e comunicação quando não havia combate iminente. <br>

                        A armadura Maximiliana refletia o gosto pela ostentação e a exibição de riqueza e poder durante
                        o Renascimento. Era frequentemente encomendada por nobres e membros da alta sociedade, que a
                        utilizavam em torneios, cerimônias e eventos importantes. A armadura Maximiliana foi um exemplo
                        marcante da fusão entre a funcionalidade militar e a expressão artística durante o período. <br>

                        Embora a armadura Maximiliana tenha perdido sua popularidade após a metade do século XVI, ela
                        deixou um legado duradouro na história das armaduras medievais. Seu estilo extravagante e
                        detalhado continua a fascinar e inspirar a arte e a cultura até os dias de hoje. <br>
                    </p>

                    <div class="imgArmadura">
                        <img class="armadura3" src="img-armour/maximilianarmor1.jpg">
                        <img class="armadura3" src="img-armour/maximilianarmor2.jpg">
                        <img class="armadura3" src="img-armour/maximilianarmor3.jpg">
                    </div>

                </div>

                <div id="estiloGreenwich">

                    <p id="paragraph">
                        <span id="destaque">Estilo Greenwich:</span> <br> <br>
                        As armaduras de Greenwich foram fabricadas na oficina de armaduras do Palácio de Greenwich em
                        Londres a partir da metade século XVI. Essas armaduras eram feitas sob medida para a elite nobre
                        e eram
                        conhecidas por sua qualidade e detalhes requintados. Essas armaduras estão associadas ao reinado
                        do Rei <span id="destaque2">Henrique VIII</span> da Inglaterra e são
                        consideradas notáveis pelo seu design e qualidade. <br>

                        As armaduras de Greenwich são consideradas exemplos notáveis da alta qualidade e sofisticação da
                        armadura inglesa do século XVI. Elas demonstram o estilo e o gosto estético da época, bem como a
                        habilidade dos artesãos e armeiros envolvidos na sua produção. <br>

                        Atualmente, muitas dessas armaduras estão preservadas e podem ser vistas no <i>Royal Armouries
                            Museum</i>, em Leeds no Reino Unido. Lá, os visitantes têm a oportunidade de apreciar essas
                        impressionantes armaduras e aprender mais sobre a sua história e significado. <br>
                    </p>

                    <div class="imgArmadura">
                        <img class="armadura4" src="img-armour/greenwicharmor1.jpg">
                        <img class="armadura4" src="img-armour/greenwicharmor2.jpg">
                        <img class="armadura4" src="img-armour/greenwicharmor3.jpg">
                    </div>

                </div>

                <div id="metricaArmaduras">

                    <p id="paragraphGraficos">
                        <span id="destaque">Preferência de armaduras dos usuários:</span> <br> <br>
                    </p>

                    <div class="grafico">

                        <canvas id="armaduraBarra" </canvas>

                    </div>

                </div>

                <p id="paragraphSubtitle">Galeria: Armaduras Famosas</p> <br> <br>

            </div>

        </div>

    </main>

</body>

</html>

<script>

    let proximaAtualizacao;

    window.onload = obterDadosGraficos();

    function obterDadosGraficos() {
        obterDadosGrafico(1)
    }



    // O gráfico é construído com três funções:
    // 1. obterDadosGrafico -> Traz dados do Banco de Dados para montar o gráfico da primeira vez
    // 2. plotarGrafico -> Monta o gráfico com os dados trazidos e exibe em tela
    // 3. atualizarGrafico -> Atualiza o gráfico, trazendo novamente dados do Banco

    // Esta função *obterDadosGrafico* busca os últimos dados inseridos em tabela de medidas.
    // para, quando carregar o gráfico da primeira vez, já trazer com vários dados.
    // A função *obterDadosGrafico* também invoca a função *plotarGrafico*

    //     Se quiser alterar a busca, ajuste as regras de negócio em src/controllers
    //     Para ajustar o "select", ajuste o comando sql em src/models
    function obterDadosGrafico(idAquario) {



        if (proximaAtualizacao != undefined) {
            clearTimeout(proximaAtualizacao);
        }

        fetch(`/medidas/buscarArmaduras/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    resposta.reverse();

                    plotarGrafico(resposta, idAquario);

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    // Esta função *plotarGrafico* usa os dados capturados na função anterior para criar o gráfico
    // Configura o gráfico (cores, tipo, etc), materializa-o na página e, 
    // A função *plotarGrafico* também invoca a função *atualizarGrafico*
    function plotarGrafico(resposta, idAquario) {

        console.log('iniciando plotagem do gráfico...');

        // Criando estrutura para plotar gráfico - labels
        let labels = [];

        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: '',
                data: [],
            },
            {
                label: 'Armaduras Favoritas',
                data: [],
                fill: false,
                borderColor: 'rgb(199, 52, 52)',
                backgroundColor: ['#d9b100', '#d9b100', '#d9b100', '#d9b100'],
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.Armadura);
            dados.datasets[0].data.push(registro.Armadura);
            dados.datasets[1].data.push(registro.Voto);
        }

        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'bar',
            data: dados,
        };

        // Adicionando gráfico criado em div na tela
        let myChart = new Chart(
            document.getElementById(`armaduraBarra`),
            config
        );

        setTimeout(() => atualizarGrafico(idAquario, dados, myChart), 2000);
    }


    // Esta função *atualizarGrafico* atualiza o gráfico que foi renderizado na página,
    // buscando a última medida inserida em tabela contendo as capturas, 

    //     Se quiser alterar a busca, ajuste as regras de negócio em src/controllers
    //     Para ajustar o "select", ajuste o comando sql em src/models
    function atualizarGrafico(idAquario, dados, myChart) {



        fetch(`/medidas/buscarArmaduras/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterdados(idAquario);
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    let avisoCaptura = document.getElementById(`avisoCaptura${idAquario}`)
                    avisoCaptura.innerHTML = ""


                    if (novoRegistro[0].momento_grafico == dados.labels[dados.labels.length - 1]) {
                        console.log("---------------------------------------------------------------")
                        console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                        avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                        console.log("Horário do novo dado capturado:")
                        console.log(novoRegistro[0].momento_grafico)
                        console.log("Horário do último dado capturado:")
                        console.log(dados.labels[dados.labels.length - 1])
                        console.log("---------------------------------------------------------------")
                    } else {
                        // tirando e colocando valores no gráfico
                        dados.labels.push(novoRegistro[0].momento_grafico); // incluir um novo momento


                        dados.datasets[0].data.push(novoRegistro[0].umidade); // incluir uma nova medida de umidade


                        dados.datasets[1].data.push(novoRegistro[0].temperatura); // incluir uma nova medida de temperatura
                    }

                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico(idAquario, dados, myChart), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico(idAquario, dados, myChart), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }
</script>